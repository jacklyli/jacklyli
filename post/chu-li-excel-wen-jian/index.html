<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>处理Excel文件 | Jacklyli </title>
<link rel="shortcut icon" href="https://jacklyli.github.io//favicon.ico">
<link rel="stylesheet" href="https://jacklyli.github.io//styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://jacklyli.github.io/">
  <img class="avatar" src="https://jacklyli.github.io//images/avatar.png" alt="" width="80px" height="80px">
  </a>
  <h1 class="site-title">
    Jacklyli 
  </h1>
  <p class="site-description">
    自己的心情记录
  </p>
  <div class="menu-container">
    
      
        <a href="https://jacklyli.github.io/" class="menu">
          首页
        </a>
      
    
      
        <a href="https://jacklyli.github.io//archives" class="menu">
          归档
        </a>
      
    
      
        <a href="https://jacklyli.github.io//tags" class="menu">
          标签
        </a>
      
    
      
        <a href="https://jacklyli.github.io//post/xiao-bai-de-di-yi-pian/" class="menu">
          关于
        </a>
      
    
  </div>
</div>

      
        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              处理Excel文件
            </h2>
            <div class="post-info">
              <time class="post-time">
                · 2019-02-17 ·
              </time>
              
                <a href="https://jacklyli.github.io//tag/uWdYyQrN-" class="post-tags">
                  # Python
                </a>
              
            </div>
            <div class="post-content">
              <p>[TOC]</p>
<h2 id="excel-">Excel文件解析</h2>
<h3 id="1-excel-">1. 访问Excel文件中的工作表：</h3>
<pre><code>import xlrd
book = xlrd.open_workbook(&#39;data/chp4/SOWC 2014 Stat Tables_Table 9.xlsx&#39;)
for sheet in book.sheets():
    print(sheet)</code></pre><p>用<code>sheet</code> 的时候回输出：<code>&lt;xlrd.sheet.Sheet object at 0x0000017E6B7DEF98&gt;
&lt;xlrd.sheet.Sheet object at 0x0000017E6B82C390&gt;</code> 如果需要输出表单的名称则需要用 <code>print(sheet.name)</code><br>这时候就会输出Excel文件中的表单名称：</p>
<pre><code>Data Notes
Table 9</code></pre><h3 id="2-">2. 访问表单中的数据</h3>
<p>计算总行数</p>
<pre><code>import xlrd
book = xlrd.open_workbook(&#39;data/chp4/SOWC 2014 Stat Tables_Table 9.xlsx&#39;)
sheet = book.sheet_by_name(&#39;Table 9 &#39;)
print(sheet.nrows)</code></pre><h3 id="3-">3. 找到数据中国家出现的位置</h3>
<pre><code>import xlrd
book = xlrd.open_workbook(&#39;data/chp4/SOWC 2014 Stat Tables_Table 9.xlsx&#39;)
sheet = book.sheet_by_name(&#39;Table 9 &#39;)
count = 0
for i in range(sheet.nrows):
    if count&lt;20:
        row = sheet.row_values(i)
        print(i,row)
    count +=1</code></pre><p>我们将会得到下面的输出结果：</p>
<pre><code>0 [&#39;&#39;, &#39;TABLE 9. CHILD PROTECTION&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
1 [&#39;&#39;, &#39;&#39;, &#39;TABLEAU 9. PROTECTION DE L’ENFANT&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;
, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
2 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;TABLA 9. PROTECCIÓN INFANTIL&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
3 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
4 [&#39;&#39;, &#39;Countries and areas&#39;, &#39;&#39;, &#39;&#39;, &#39;Child labour (%)+\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Child marriage (%)\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;Birth registration (%)+\n2005–2012*&#39;, &#39;&#39;, &#39;Female genital mutilation/cutting (%)+\n2002–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Justification of wi
fe beating (%)\n 2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Violent discipline (%)+\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;&#39;, &#39;&#39;, &#39;&#39;]
5 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;prevalence&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;attitudes&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
6 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;male&#39;, &#39;&#39;, &#39;female&#39;, &#39;&#39;, &#39;married by 15&#39;, &#39;&#39;, &#39;married by 18&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;womena &#39;, &#39;&#39;, &#39;girlsb &#39;, &#39;&#39;, &#39;support for the practicec&#39;, &#39;&#39;, &#39;male&#39;, &#39;&#39;, &#39;female&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;male&#39;, &#39;&#39;, &#39;female&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;&#39;, &#39;&#39;, &#39;&#39;]
7 [&#39;&#39;, &#39;FRENCH HEADINGS&#39;, &#39;Pays et zones&#39;, &#39;&#39;, &#39;Travail des enfants (%)+\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Mariage d’enfants (%)\n2005–
2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Enregistrement\ndes naissances\n(%)+\n2005–2012*\n&#39;, &#39;&#39;, &#39;Mutilations génitales féminines/excision (%)+\n2002–2012*&#39;
, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Justification de la\nviolence conjugale (%)\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Discipline imposée par la violence (%)+\n200
5–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
8 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;prévalence&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;attitudes&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
9 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;garçons&#39;, &#39;&#39;, &#39;filles&#39;, &#39;&#39;, &#39;marié à 15 ans\n&#39;, &#39;&#39;, &#39;marié à 18 ans&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;femmes a &#39;, &#39;&#39;, &#39;filles b &#39;, &#39;&#39;, &#39;soutien à cette pratique c&#39;, &#39;&#39;, &#39;hommes&#39;, &#39;&#39;, &#39;femmes&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;garçons&#39;, &#39;&#39;, &#39;filles&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
10 [&#39;&#39;, &#39;SPANISH HEADINGS&#39;, &#39;&#39;, &#39;Países y zonas&#39;, &#39;Trabajo infantil (%)+ 2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Matrimonio precoz (%) 2005–201
2*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Inscripción del\nnacimiento (%) + 2005–2012*&#39;, &#39;&#39;, &#39;Mutilación/excisión genital (%)+\n2002–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;,
&#39;Justificación de golpear\na la mujer (%)\n2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;Disciplina violenta (%)+ 2005–2012*&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;
&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
11 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;prevalencia&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;actitudes&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
12 [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;hombre&#39;, &#39;&#39;, &#39;mujer&#39;, &#39;&#39;, &#39;casados a los 15 años&#39;, &#39;&#39;, &#39;casados a los 18 años&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;Mujeresa &#39;, &#39;&#39;, &#39;hijasb &#39;, &#39;&#39;, &#39;apoyo a la prácticac&#39;, &#39;&#39;, &#39;hombre&#39;, &#39;&#39;, &#39;mujer&#39;, &#39;&#39;, &#39;total&#39;, &#39;&#39;, &#39;hombre&#39;, &#39;&#39;, &#39;mujer&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
13 [&#39;&#39;, &#39;&#39;, &#39;FRENCH COUNTRY NAMES&#39;, &#39;SPANISH COUNTRY NAMES&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
14 [&#39;&#39;, &#39;Afghanistan&#39;, &#39;Afghanistan&#39;, &#39;Afganistán&#39;, 10.3, &#39;&#39;, 11.0, &#39;&#39;, 9.6, &#39;&#39;, 15.0, &#39;&#39;, 40.4, &#39;&#39;, 37.4, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;
, &#39;–&#39;, &#39;&#39;, 90.2, &#39;&#39;, 74.4, &#39;&#39;, 74.8, &#39;&#39;, 74.1, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
15 [&#39;&#39;, &#39;Albania&#39;, &#39;Albanie&#39;, &#39;Albania&#39;, 12.0, &#39; &#39;, 14.4, &#39; &#39;, 9.4, &#39; &#39;, 0.2, &#39;&#39;, 9.6, &#39;&#39;, 98.6, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, 36.4,
 &#39;&#39;, 29.8, &#39;&#39;, 75.1, &#39;&#39;, 78.3, &#39;&#39;, 71.4, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
16 [&#39;&#39;, &#39;Algeria&#39;, &#39;Algérie&#39;, &#39;Argelia&#39;, 4.7, &#39;y&#39;, 5.5, &#39;y&#39;, 3.9, &#39;y&#39;, 0.1, &#39;&#39;, 1.8, &#39;&#39;, 99.3, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;,
67.9, &#39;&#39;, 87.7, &#39;&#39;, 88.8, &#39;&#39;, 86.5, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
17 [&#39;&#39;, &#39;Andorra&#39;, &#39;Andorre&#39;, &#39;Andorra&#39;, &#39;– &#39;, &#39; &#39;, &#39;–&#39;, &#39; &#39;, &#39;–&#39;, &#39; &#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, 100.0, &#39;v&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;
–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
18 [&#39;&#39;, &#39;Angola&#39;, &#39;Angola&#39;, &#39;Angola&#39;, 23.5, &#39;x&#39;, 22.1, &#39;x&#39;, 24.8, &#39;x&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, 36.0, &#39;x&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;
&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]
19 [&#39;&#39;, &#39;Antigua and Barbuda&#39;, &#39;Antigua-et-Barbuda&#39;, &#39;Antigua y Barbuda&#39;, &#39;–&#39;, &#39; &#39;, &#39;–&#39;, &#39; &#39;, &#39;–&#39;, &#39; &#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;
–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;–&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</code></pre><p>从输出的结果可以看到在第14行的时候输出了国家的数据；这就是我们想要获得是数据；<br>在Excel表中可以看到的数据是这样的（其中法语和西班牙语的表头我隐藏了方便查看）<br>Countries and areas    Child labour (%)+<br>2005–2012*    Child marriage (%)<br>2005–2012*    Birth registration (%)+<br>2005–2012*    Female genital mutilation/cutting (%)+<br>2002–2012*    Justification of wife beating (%)<br> 2005–2012*    Violent discipline (%)+<br>2005–2012*<br>prevalence    attitudes<br>total    male    female    married by 15    married by 18    total    womena      girlsb     support for the practicec    male    female    total    male    female<br>Afghanistan    10    　    11    　    10    　    15    　    40    　    37    　    –    　    –    　    –    　    –    　    90    　    74    　    75    　    74    　<br>Albania    12          14          9          0    　    10    　    99    　    –    　    –    　    –    　    36    　    30    　    75    　    78    　    71    　<br>Algeria    5    y    6    y    4    y    0    　    2    　    99    　    –    　    –    　    –    　    –    　    68    　    88    　    89    　    87    　<br>Andorra    –          –         –          –    　    –    　    100    v    –    　    –    　    –    　    –    　    –    　    –    　    –    　    –    　<br>Angola    24    x    22    x    25    x    –    　    –    　    36    x    –    　    –    　    –    　    –    　    –    　    –    　    –    　    –    　</p>
<p>在表格中需要找到数据所在的位置：可以查看下图的数据</p>
<p>Countries and areas    　    　    Child labour (%)+<br>2005–2012*    Child marriage (%)<br>2005–2012*</p>
<p>total    male    female    married by 15    married by 18</p>
<p>Afghanistan    Afghanistan    Afganistán    10    　    11    　    10    　    15    　    40    　</p>
<p>Albania    Albanie    Albania    12          14          9          0    　    10    　</p>
<p>Algeria    Algérie    Argelia    5    y    6    y    4    y    0    　    2    　</p>
<pre><code>import xlrd
import pprint
book = xlrd.open_workbook(&#39;data/chp4/SOWC 2014 Stat Tables_Table 9.xlsx&#39;)
sheet = book.sheet_by_name(&#39;Table 9 &#39;)
count = 0
data = {}

for i in range(14,sheet.nrows):
    row = sheet.row_values(i)
    country = row[1]

    data[country] = {
        &#39;child_labor&#39;:{
            &#39;total&#39;:[row[4],row[5]],
            &#39;male&#39;:[row[6],row[7]],
            &#39;female&#39;:[row[8],row[9]],
        },
        &#39;child_marriage&#39;:{
            &#39;married_by_15&#39;:[row[10],row[11]],
            &#39;married_by_18&#39;:[row[12],row[13]],
        }
    }
pprint.pprint(data[&#39;Afghanistan&#39;]</code></pre><p>输出结果为：</p>
<pre><code>{&#39;child_labor&#39;: {&#39;female&#39;: [9.6, &#39;&#39;], &#39;male&#39;: [11.0, &#39;&#39;], &#39;total&#39;: [10.3, &#39;&#39;]},
 &#39;child_marriage&#39;: {&#39;married_by_15&#39;: [15.0, &#39;&#39;], &#39;married_by_18&#39;: [40.4, &#39;&#39;]}}</code></pre><p>在这里我们引入了<code>pprint</code>这个库；为了将结果输出好看些；否则在使用<code>print</code>的时候会输出<code>{&#39;child_labor&#39;: {&#39;total&#39;: [10.3, &#39;&#39;], &#39;male&#39;: [11.0, &#39;&#39;], &#39;female&#39;: [9.6, &#39;&#39;]}, &#39;child_marriage&#39;: {&#39;married_by_15&#39;: [15.0, &#39;&#39;], &#39;married_by_18&#39;: [40.4, &#39;&#39;]}}</code><br>和部方便查看结果！<br><font color=red size=5>另外需要注意的地方：row的索引也是从0开始的；</font></p>

            </div>
          </article>
        </div>
    
        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://jacklyli.github.io//post/chang-yong-de-shu-ju-chu-li-han-shu">
              <h3 class="post-title">
                常用的数据处理函数
              </h3>
            </a>
          </div>  
        

        
    
        <div class="site-footer">
  Powered by Hve Notes
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
